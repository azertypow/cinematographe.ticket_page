app.factory("CartService",["$controller","$http","$rootScope","$modal",function($controller,$http,$rootScope,$modal){return{get_cart:function($scope){return $controller("CartCtrl",{$scope:$scope,$http:$http,$rootScope:$rootScope,$modal:$modal})},add_wallet_operation:function(ticket_id,amount,vat,callback){var url="/carts/add_wallet_operation";if(ticketack.session_id){url+="?PHPSESSID="+ticketack.session_id}var data={ticket_id:ticket_id,amount:amount,vat:vat};var headers={"Content-Type":"application/json"};$http({method:"POST",url:url,data:data,headers:headers}).success((function(rsp,status,headers,config){callback&&callback(null,rsp)})).error((function(rsp,status,headers,config){callback&&callback(rsp.flash?rsp.flash.error:new Error)}))},add_and_pay_wallet_operation:function(ticket_id,amount,vat,callback){var operation=amount>0?"credit_wallet":"debit_wallet";var url="/tickets/"+operation+"/_id/"+ticket_id;if(ticketack.session_id){url+="?PHPSESSID="+ticketack.session_id}var data={amount:Math.abs(amount),vat:vat};var headers={"Content-Type":"application/json"};$http({method:"POST",url:url,data:data,headers:headers}).success((function(rsp,status,headers,config){callback&&callback(null,rsp)})).error((function(rsp,status,headers,config){callback&&callback(rsp.flash?rsp.flash.error:new Error)}))},add_como_debit_operation:function(phoneNumber,amount,vat,callback){var url="/carts/add_como_debit_operation";if(ticketack.session_id){url+="?PHPSESSID="+ticketack.session_id}var data={phoneNumber:phoneNumber,amount:amount,vat:vat};var headers={"Content-Type":"application/json"};$http({method:"POST",url:url,data:data,headers:headers}).success((function(rsp,status,headers,config){callback&&callback(null,rsp)})).error((function(rsp,status,headers,config){callback&&callback(rsp.flash?rsp.flash.error:new Error)}))},add_como_asset_operation:function(phoneNumber,asset,vat,callback){var url="/carts/add_como_asset_operation";if(ticketack.session_id){url+="?PHPSESSID="+ticketack.session_id}var data={phoneNumber:phoneNumber,asset:asset,vat:vat};var headers={"Content-Type":"application/json"};$http({method:"POST",url:url,data:data,headers:headers}).success((function(rsp,status,headers,config){callback&&callback(null,rsp)})).error((function(rsp,status,headers,config){callback&&callback(rsp.flash?rsp.flash.error:new Error)}))},add_como_promo_code_operation:function(phoneNumber,promoCode,vat,callback){var url="/carts/add_como_promo_code_operation";if(ticketack.session_id){url+="?PHPSESSID="+ticketack.session_id}var data={promoCode:promoCode,vat:vat};if(phoneNumber)data.phoneNumber=phoneNumber;var headers={"Content-Type":"application/json"};$http({method:"POST",url:url,data:data,headers:headers}).success((function(rsp,status,headers,config){callback&&callback(null,rsp)})).error((function(rsp,status,headers,config){callback&&callback(rsp.flash?rsp.flash.error:new Error)}))}}}]);
